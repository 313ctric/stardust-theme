{% import "macros/formatters.html" as formatters %}

{% macro merch_item(page) %}

<div class="card p-0 m-4">
    <div class="d-flex align-items-center">
        {% if page.assets | length > 0 %}
        <div id="carousel-{{ page.slug }}" class="carousel zoom slide rounded-start w-100 h-100 overflow-hidden"
            style="aspect-ratio: 1 / 1">
            <div class="carousel-inner">
                {% for asset in page.assets | sort -%}
                    {%- if asset is matching("[.](jpg|png)$") -%}
                        <div class="carousel-item {% if loop.first %} active{% endif %}" {% if not loop.first %} loading="lazy"{% endif %}>
                            <img class="d-block w-100" style="aspect-ratio: 1 / 1; object-fit: contain;" src=" {{ asset }}">
                        </div>
                    {%- endif %}
                {%- endfor %}
            </div>
            {% if page.assets | length > 1 %}
                <button class="carousel-control-prev" type="button" data-bs-target="#carousel-{{ page.slug }}" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#carousel-{{ page.slug }}" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            {% endif %}
        </div>

        <div class="col-md-8">
        {% else %}
        <div>
        {% endif %}
            <div class="card-body p-4 d-flex flex-column h-100 justify-content-between">
                <div>
                    <div class="d-flex align-items-center">
                        <h5 class="card-title fs-1">{{ page.title }}</h5>
                        <span class="badge rounded-pill text-bg-primary fs-4 ms-auto">£{{ page.extra.price }}</span>
                    </div>
                    <div class="card-text flex-grow-1">
                        {{ page.content | safe }}
                    </div>
                </div>
                {% if not shop.preview %}
                <a class="btn btn-primary btn-lg mt-3" href="{{ page.extra.link }}" target="_blank" rel="noopener noreferrer">
                    <i class="bi-cart-fill"></i> Buy for £{{ page.extra.price }} @ Warwick SU
                </a>
                {% endif %}
            </div>
        </div>
    </div>
</div>

{% endmacro %}